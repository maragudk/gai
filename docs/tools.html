<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tools - GAI Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>document.addEventListener('DOMContentLoaded', (event) => { hljs.highlightAll(); });</script>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold flex items-center">
                <span class="mr-2">GAI</span>
                <span class="text-sm bg-blue-800 px-2 py-1 rounded-md">Go Artificial Intelligence</span>
            </a>
            <nav class="hidden md:flex space-x-4">
                <a href="index.html" class="px-3 py-2 hover:bg-blue-700 rounded">Home</a>
                <a href="getting-started.html" class="px-3 py-2 hover:bg-blue-700 rounded">Getting Started</a>
                <a href="concepts.html" class="px-3 py-2 hover:bg-blue-700 rounded">Concepts</a>
                <a href="examples.html" class="px-3 py-2 hover:bg-blue-700 rounded">Examples</a>
                <a href="https://github.com/maragudk/gai" class="px-3 py-2 hover:bg-blue-700 rounded" target="_blank">GitHub</a>
            </nav>
            <button class="md:hidden block text-white" id="mobile-menu-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
        <!-- Mobile menu (hidden by default) -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 bg-blue-700">
                <a href="index.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Home</a>
                <a href="getting-started.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Getting Started</a>
                <a href="concepts.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Concepts</a>
                <a href="examples.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Examples</a>
                <a href="https://github.com/maragudk/gai" class="block px-3 py-2 hover:bg-blue-800 rounded" target="_blank">GitHub</a>
            </div>
        </div>
    </header>

    <!-- Main content -->
    <div class="flex flex-grow">
        <!-- Sidebar -->
        <aside class="hidden md:block w-64 bg-white shadow-md p-4">
            <nav class="space-y-1">
                <div class="font-bold mb-2 text-gray-700">Documentation</div>
                <a href="getting-started.html" class="block py-2 px-4 rounded hover:bg-gray-100">Getting Started</a>
                <a href="concepts.html" class="block py-2 px-4 rounded hover:bg-gray-100">Core Concepts</a>
                <a href="chat-completion.html" class="block py-2 px-4 rounded hover:bg-gray-100">Chat Completion</a>
                <a href="embedding.html" class="block py-2 px-4 rounded hover:bg-gray-100">Embedding</a>
                <a href="tools.html" class="block py-2 px-4 rounded bg-blue-50 text-blue-600 font-medium">Tools</a>
                <a href="evals.html" class="block py-2 px-4 rounded hover:bg-gray-100">Evaluations</a>
                <a href="examples.html" class="block py-2 px-4 rounded hover:bg-gray-100">Examples</a>
            </nav>
            
            <!-- Table of Contents -->
            <div class="mt-8">
                <div class="font-bold mb-2 text-gray-700">On This Page</div>
                <nav class="space-y-1 text-sm">
                    <a href="#core-concepts" class="block py-1 px-4 rounded hover:bg-gray-100">Core Concepts</a>
                    <a href="#defining-tools" class="block py-1 px-4 rounded hover:bg-gray-100">Defining Tools</a>
                    <a href="#argument-schema" class="block py-1 px-4 rounded hover:bg-gray-100">Argument Schema</a>
                    <a href="#tool-function" class="block py-1 px-4 rounded hover:bg-gray-100">Tool Function</a>
                    <a href="#using-tools" class="block py-1 px-4 rounded hover:bg-gray-100">Using Tools</a>
                    <a href="#handling-calls" class="block py-1 px-4 rounded hover:bg-gray-100">Handling Tool Calls</a>
                    <a href="#included-tools" class="block py-1 px-4 rounded hover:bg-gray-100">Included Tools</a>
                    <a href="#example" class="block py-1 px-4 rounded hover:bg-gray-100">Complete Example</a>
                    <a href="#best-practices" class="block py-1 px-4 rounded hover:bg-gray-100">Best Practices</a>
                </nav>
            </div>
        </aside>

        <!-- Content -->
        <main class="flex-grow p-6">
            <div class="container mx-auto max-w-3xl">
                <div class="mb-6">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Tools</h1>
                    <p class="text-lg text-gray-700">Tools extend model capabilities. They let models interact with external systems to fetch information or perform actions.</p>
                </div>

                <div class="space-y-12">
                    <section id="core-concepts" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Core Concepts</h2>
                        
                        <p class="mb-4">A tool in GAI consists of:</p>
                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Name</h3>
                                <p class="text-sm">Unique identifier for the tool</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Description</h3>
                                <p class="text-sm">Explains what the tool does (guides the model)</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Schema</h3>
                                <p class="text-sm">JSON schema for arguments</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Function</h3>
                                <p class="text-sm">The actual code that executes when called</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="bg-blue-100 p-3 rounded-full mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-blue-700">Tools allow AI models to interact with external systems, retrieve information, or perform actions they couldn't do with language capabilities alone. This dramatically extends what models can do for users.</p>
                            </div>
                        </div>
                    </section>

                    <section id="defining-tools" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Defining Tools</h2>
                        
                        <p class="mb-4">Define a tool with these components:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">tool := gai.Tool{
    Name:        "weather",
    Description: "Get current weather for a location",
    Schema:      gai.GenerateSchema[WeatherArgs](),
    Function:    weatherFunction,
}</code></pre>
                        </div>
                        
                        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                            <h4 class="font-bold text-yellow-800 mb-1">Tool Naming Tips</h4>
                            <p class="text-yellow-700">
                                Use clear, concise names that indicate exactly what the tool does. The name should be a noun or verb phrase like "weather", "search_database", or "create_reminder".
                            </p>
                        </div>
                    </section>

                    <section id="argument-schema" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Argument Schema</h2>
                        
                        <p class="mb-4">Define argument types with structs and JSON tags:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">type WeatherArgs struct {
    Location string `json:"location" jsonschema_description:"City name or coordinates"`
    Units    string `json:"units,omitempty" jsonschema_description:"Units (metric/imperial)"`
}</code></pre>
                        </div>
                        
                        <p class="mb-4">The <code>jsonschema_description</code> tags provide guidance to models.</p>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-bold text-green-800 mb-1">Best Practices</h4>
                            <ul class="list-disc pl-6 space-y-1 text-green-700 text-sm">
                                <li>Always include descriptive <code>jsonschema_description</code> tags</li>
                                <li>Mark optional fields with <code>omitempty</code></li>
                                <li>Keep the schema as simple as possible</li>
                                <li>Use appropriate types (string, number, boolean, etc.)</li>
                            </ul>
                        </div>
                    </section>

                    <section id="tool-function" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Tool Function</h2>
                        
                        <p class="mb-4">Implement the execution logic:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">func weatherFunction(ctx context.Context, rawArgs json.RawMessage) (string, error) {
    var args WeatherArgs
    if err := json.Unmarshal(rawArgs, &args); err != nil {
        return "", fmt.Errorf("error parsing weather args: %w", err)
    }
    
    // Call weather API, etc.
    weather := fetchWeather(args.Location, args.Units)
    
    return fmt.Sprintf("Current temperature in %s: %.1f°C", args.Location, weather.Temperature), nil
}</code></pre>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-gray-800 mb-2">1. Parse Arguments</h4>
                                <p class="text-xs text-gray-600">Unmarshal the JSON args into your typed struct</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-gray-800 mb-2">2. Execute Function</h4>
                                <p class="text-xs text-gray-600">Perform the actual work (API calls, database queries, etc.)</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-gray-800 mb-2">3. Return Results</h4>
                                <p class="text-xs text-gray-600">Return a formatted string result or error</p>
                            </div>
                        </div>
                    </section>

                    <section id="using-tools" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Using Tools with Chat Completion</h2>
                        
                        <p class="mb-4">Add tools to chat requests:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">request := gai.ChatCompleteRequest{
    Messages: []gai.Message{
        gai.NewUserTextMessage("What's the weather in New York?"),
    },
    Tools: []gai.Tool{weatherTool, timeTool},
}

response, err := client.ChatComplete(context.Background(), request)
if err != nil {
    // Handle error
}</code></pre>
                        </div>
                        
                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                            <h4 class="font-bold text-purple-800 mb-1">How Models Use Tools</h4>
                            <p class="text-purple-700">
                                The model analyzes the conversation and decides when to call a tool. It's guided by the tools' names and descriptions, and the format of their argument schemas. Provide clear descriptions to help the model know when to use a particular tool.
                            </p>
                        </div>
                    </section>

                    <section id="handling-calls" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Handling Tool Calls</h2>
                        
                        <p class="mb-4">Process tool calls in response stream:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">for part, err := range response.Parts() {
    if err != nil {
        // Handle error
        break
    }
    
    if part.Type == gai.MessagePartTypeToolCall {
        toolCall := part.ToolCall()
        
        // Execute the tool
        var result string
        var toolErr error
        
        if toolCall.Name == "weather" {
            result, toolErr = handleWeatherTool(ctx, toolCall.Args)
        }
        
        // Send tool result back to model
        toolResult := gai.ToolResult{
            ID:      toolCall.ID,
            Content: result,
            Err:     toolErr,
        }
        
        // Add tool result to conversation
        toolResultMsg := gai.NewUserToolResultMessage(toolResult)
        
        // Continue conversation with tool result
        continueRequest := gai.ChatCompleteRequest{
            Messages: append(request.Messages, toolResultMsg),
            Tools:    request.Tools,
        }
        
        // Get new response...
    } else if part.Type == gai.MessagePartTypeText {
        // Handle text response
        fmt.Print(part.Text())
    }
}</code></pre>
                        </div>
                        
                        <div class="flex flex-col md:flex-row gap-4 mt-8">
                            <div class="flex-1 p-4 bg-blue-50 rounded-lg">
                                <h4 class="font-bold mb-2">Tool Call Flow</h4>
                                <ol class="list-decimal pl-5 text-sm space-y-2">
                                    <li>Model makes a tool call in the response</li>
                                    <li>Your code detects the tool call and executes the requested tool</li>
                                    <li>You create a tool result with the output</li>
                                    <li>You send the result back to the model</li>
                                    <li>The model continues the conversation</li>
                                </ol>
                            </div>
                            <div class="flex-1 p-4 bg-red-50 rounded-lg">
                                <h4 class="font-bold mb-2">Common Pitfalls</h4>
                                <ul class="list-disc pl-5 text-sm space-y-2">
                                    <li>Not handling all tool types</li>
                                    <li>Forgetting to catch and return tool errors</li>
                                    <li>Not including the tool result in the next request</li>
                                    <li>Missing the tool's ID in the result</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <section id="included-tools" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Included Tools</h2>
                        
                        <p class="mb-4">GAI includes ready-to-use tools:</p>
                        
                        <h3 class="text-xl font-bold mb-3">File Tools</h3>
                        <p class="mb-4">File access tools for reading and writing:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">root := os.New("/path/to/files")
readFileTool := tools.NewReadFile(root)
listDirTool := tools.NewListDir(root)
editFileTool := tools.NewEditFile(root)</code></pre>
                        </div>
                        
                        <h3 class="text-xl font-bold mb-3">Memory Tools</h3>
                        <p class="mb-4">Tools for storing and retrieving information:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">// Create memory storage backend
memoryStore := memoryStore{}

// Create memory tools
saveMemoryTool := tools.NewSaveMemory(memoryStore)
getMemoriesTool := tools.NewGetMemories(memoryStore)
searchMemoriesTool := tools.NewSearchMemories(memoryStore)</code></pre>
                        </div>
                        
                        <h3 class="text-xl font-bold mb-3">Time Tool</h3>
                        <p class="mb-4">Get current time information:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">timeTool := tools.NewTime()</code></pre>
                        </div>
                        
                        <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4 mt-4">
                            <h4 class="font-bold text-indigo-800 mb-1">Add Your Own Tools</h4>
                            <p class="text-indigo-700 text-sm">
                                These built-in tools are just the start. You can create custom tools for any functionality you need: database searches, API calls, custom calculations, or integration with your application's specific features.
                            </p>
                        </div>
                    </section>

                    <section id="example" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Complete Example</h2>
                        
                        <p class="mb-4">A complete example using weather and time tools:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">package main

import (
    "context"
    "encoding/json"
    "fmt"
    "log"
    "os"
    "time"

    "maragu.dev/gai"
    "maragu.dev/gai/tools"
    openai "github.com/maragudk/gai-openai"
)

type WeatherArgs struct {
    Location string `json:"location" jsonschema_description:"City name or coordinates"`
}

func main() {
    // Create tools
    weatherTool := gai.Tool{
        Name:        "weather",
        Description: "Get current weather for a location",
        Schema:      gai.GenerateSchema[WeatherArgs](),
        Function: func(ctx context.Context, rawArgs json.RawMessage) (string, error) {
            var args WeatherArgs
            if err := json.Unmarshal(rawArgs, &args); err != nil {
                return "", err
            }
            return fmt.Sprintf("It's sunny and 22°C in %s", args.Location), nil
        },
    }
    
    timeTool := tools.NewTime()
    
    // Create client
    client := openai.NewClient(os.Getenv("OPENAI_API_KEY"))
    
    // Create request with tools
    request := gai.ChatCompleteRequest{
        Messages: []gai.Message{
            gai.NewUserTextMessage("What's the weather in Paris and what time is it?"),
        },
        Tools: []gai.Tool{weatherTool, timeTool},
    }
    
    // Use the tools in a conversation
    conductConversation(client, request)
}

// For brevity, implementation of conductConversation is omitted</code></pre>
                        </div>
                        
                        <div class="bg-gray-100 p-4 rounded border-l-4 border-gray-400 mt-6">
                            <p class="text-gray-700">
                                In a real application, you would implement the <code>conductConversation</code> function to handle the chat flow, process tool calls, and manage the conversation state. See the <a href="examples.html" class="text-blue-600 hover:text-blue-800">Examples</a> section for more complete implementations.
                            </p>
                        </div>
                    </section>

                    <section id="best-practices" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Best Practices</h2>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Clear Descriptions</h3>
                                <p class="text-sm">Keep tool descriptions concise and clear to help the model understand when to use them</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Error Handling</h3>
                                <p class="text-sm">Handle errors gracefully and return informative error messages</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Specific Arguments</h3>
                                <p class="text-sm">Be specific about argument requirements with detailed schemas</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Time Limits</h3>
                                <p class="text-sm">Limit tool execution time to avoid long-running operations</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Structured Data</h3>
                                <p class="text-sm">Return structured data when possible to make it easier for the model to use</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h3 class="font-bold mb-2">Security Considerations</h3>
                                <p class="text-sm">Always sanitize inputs and limit access to sensitive operations</p>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded mt-6">
                            <h4 class="font-bold text-yellow-800 mb-1">Important</h4>
                            <p class="text-yellow-700">
                                Always validate and sanitize tool inputs, especially if they might interact with your systems or external services. Never blindly execute operations based on model requests without proper validation.
                            </p>
                        </div>
                    </section>
                </div>
                
                <div class="mt-12 flex space-x-4">
                    <a href="embedding.html" class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded inline-flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        Embedding
                    </a>
                    <a href="evals.html" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded inline-flex items-center">
                        Evaluations
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </a>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between">
                <div class="mb-4 md:mb-0">
                    <h3 class="text-xl font-bold mb-2">GAI</h3>
                    <p class="text-gray-300">Go Artificial Intelligence - Work with AI models in Go</p>
                </div>
                <div>
                    <h4 class="font-bold mb-2 mt-4 md:mt-0">Links</h4>
                    <ul class="space-y-1">
                        <li><a href="https://github.com/maragudk/gai" class="text-blue-300 hover:text-white" target="_blank">GitHub Repository</a></li>
                        <li><a href="https://pkg.go.dev/maragu.dev/gai" class="text-blue-300 hover:text-white" target="_blank">Go Documentation</a></li>
                        <li><a href="mailto:markus@maragu.dk" class="text-blue-300 hover:text-white">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-4 border-t border-gray-700 text-center text-gray-400">
                <p>Made by <a href="https://www.maragu.dev/" class="text-blue-300 hover:text-white" target="_blank">maragu</a></p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>
</body>
</html>