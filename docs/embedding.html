<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedding - GAI Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>document.addEventListener('DOMContentLoaded', (event) => { hljs.highlightAll(); });</script>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold flex items-center">
                <span class="mr-2">GAI</span>
                <span class="text-sm bg-blue-800 px-2 py-1 rounded-md">Go Artificial Intelligence</span>
            </a>
            <nav class="hidden md:flex space-x-4">
                <a href="index.html" class="px-3 py-2 hover:bg-blue-700 rounded">Home</a>
                <a href="getting-started.html" class="px-3 py-2 hover:bg-blue-700 rounded">Getting Started</a>
                <a href="concepts.html" class="px-3 py-2 hover:bg-blue-700 rounded">Concepts</a>
                <a href="examples.html" class="px-3 py-2 hover:bg-blue-700 rounded">Examples</a>
                <a href="https://github.com/maragudk/gai" class="px-3 py-2 hover:bg-blue-700 rounded" target="_blank">GitHub</a>
            </nav>
            <button class="md:hidden block text-white" id="mobile-menu-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
        <!-- Mobile menu (hidden by default) -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 bg-blue-700">
                <a href="index.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Home</a>
                <a href="getting-started.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Getting Started</a>
                <a href="concepts.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Concepts</a>
                <a href="examples.html" class="block px-3 py-2 hover:bg-blue-800 rounded">Examples</a>
                <a href="https://github.com/maragudk/gai" class="block px-3 py-2 hover:bg-blue-800 rounded" target="_blank">GitHub</a>
            </div>
        </div>
    </header>

    <!-- Main content -->
    <div class="flex flex-grow">
        <!-- Sidebar -->
        <aside class="hidden md:block w-64 bg-white shadow-md p-4">
            <nav class="space-y-1">
                <div class="font-bold mb-2 text-gray-700">Documentation</div>
                <a href="getting-started.html" class="block py-2 px-4 rounded hover:bg-gray-100">Getting Started</a>
                <a href="concepts.html" class="block py-2 px-4 rounded hover:bg-gray-100">Core Concepts</a>
                <a href="chat-completion.html" class="block py-2 px-4 rounded hover:bg-gray-100">Chat Completion</a>
                <a href="embedding.html" class="block py-2 px-4 rounded bg-blue-50 text-blue-600 font-medium">Embedding</a>
                <a href="tools.html" class="block py-2 px-4 rounded hover:bg-gray-100">Tools</a>
                <a href="evals.html" class="block py-2 px-4 rounded hover:bg-gray-100">Evaluations</a>
                <a href="examples.html" class="block py-2 px-4 rounded hover:bg-gray-100">Examples</a>
            </nav>
            
            <!-- Table of Contents -->
            <div class="mt-8">
                <div class="font-bold mb-2 text-gray-700">On This Page</div>
                <nav class="space-y-1 text-sm">
                    <a href="#what-embeddings-do" class="block py-1 px-4 rounded hover:bg-gray-100">What Embeddings Do</a>
                    <a href="#creating-embeddings" class="block py-1 px-4 rounded hover:bg-gray-100">Creating Embeddings</a>
                    <a href="#generic-vectors" class="block py-1 px-4 rounded hover:bg-gray-100">Generic Vector Components</a>
                    <a href="#vector-operations" class="block py-1 px-4 rounded hover:bg-gray-100">Vector Operations</a>
                    <a href="#multiple-texts" class="block py-1 px-4 rounded hover:bg-gray-100">Working with Multiple Texts</a>
                    <a href="#semantic-search" class="block py-1 px-4 rounded hover:bg-gray-100">Semantic Search</a>
                    <a href="#memory-efficiency" class="block py-1 px-4 rounded hover:bg-gray-100">Memory Efficiency</a>
                </nav>
            </div>
        </aside>

        <!-- Content -->
        <main class="flex-grow p-6">
            <div class="container mx-auto max-w-3xl">
                <div class="mb-6">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Embedding</h1>
                    <p class="text-lg text-gray-700">Embeddings turn text into vectors. They capture semantic meaning in a machine-understandable format.</p>
                </div>

                <div class="space-y-12">
                    <section id="what-embeddings-do" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">What Embeddings Do</h2>
                        
                        <ul class="list-disc pl-6 space-y-2 mb-6">
                            <li>Convert text to numerical vectors</li>
                            <li>Position similar meanings close together</li>
                            <li>Enable similarity search</li>
                            <li>Underpin RAG applications</li>
                            <li>Allow clustering and classification</li>
                        </ul>
                        
                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                            <h4 class="font-bold text-purple-800 mb-1">Embeddings Visualized</h4>
                            <p class="text-purple-700">Think of embeddings as placing words in a multidimensional space where semantically similar words are closer together. For example, "dog" and "puppy" would be close to each other, but far from "computer" and "keyboard".</p>
                        </div>
                    </section>

                    <section id="creating-embeddings" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Creating Embeddings</h2>
                        <p class="mb-4">GAI makes embedding simple:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">request := gai.EmbedRequest{
    Input: strings.NewReader("The text you want to embed"),
}

response, err := client.Embed(context.Background(), request)
if err != nil {
    // Handle error
}

embedding := response.Embedding // Vector of float64 values</code></pre>
                        </div>
                        
                        <div class="grid md:grid-cols-3 gap-4 mb-4 text-center">
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <span class="inline-block w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mb-2">1</span>
                                <p class="text-sm">Create an embed request with input text</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <span class="inline-block w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mb-2">2</span>
                                <p class="text-sm">Send the request to an embedding model</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <span class="inline-block w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mb-2">3</span>
                                <p class="text-sm">Get back a vector representation</p>
                            </div>
                        </div>
                    </section>

                    <section id="generic-vectors" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Generic Vector Components</h2>
                        <p class="mb-4">GAI supports different numeric types for vectors through generics:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">// Embedding with float32 instead of default float64
var client gai.Embedder[float32]
response, err := client.Embed(context.Background(), request)

// Embedding with int8 for quantized vectors
var quantizedClient gai.Embedder[int8]
quantizedResponse, err := quantizedClient.Embed(context.Background(), request)</code></pre>
                        </div>
                        
                        <p class="mb-4">This flexibility helps when:</p>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>Saving memory with lower precision</li>
                            <li>Working with quantized models</li>
                            <li>Matching specific model output formats</li>
                        </ul>
                        
                        <div class="mt-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                            <h4 class="font-bold text-yellow-800 mb-1">Go Generics in Action</h4>
                            <p class="text-yellow-700">This is a great example of how Go's generics feature helps provide type safety while maintaining flexibility. The Embedder interface is parameterized to handle different numeric types without sacrificing compile-time type checking.</p>
                        </div>
                    </section>

                    <section id="vector-operations" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Vector Operations</h2>
                        <p class="mb-4">Common operations with embeddings:</p>
                        
                        <h3 class="text-xl font-bold mb-3">Cosine Similarity</h3>
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">// Using GAI's built-in function
similarity := eval.CosineSimilarity(embedding1.Embedding, embedding2.Embedding)
fmt.Printf("Cosine similarity: %f\n", similarity)</code></pre>
                        </div>
                        
                        <div class="flex items-center mt-4 mb-6 bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                            <div class="bg-indigo-100 p-3 rounded-full mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-indigo-800">What is Cosine Similarity?</h4>
                                <p class="text-sm text-indigo-700">A measure of similarity between two vectors that looks at the angle between them rather than their magnitude. Values range from -1 (opposite) to 1 (identical), with 0 indicating orthogonality (no similarity).</p>
                            </div>
                        </div>
                        
                        <h3 class="text-xl font-bold mb-3">Vector Storage</h3>
                        <p class="mb-4">Store vectors in your preferred database:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">// Store in Postgres with pgvector
_, err = db.ExecContext(ctx, 
    "INSERT INTO documents (content, embedding) VALUES ($1, $2)",
    text, pgvector.NewVector(response.Embedding))</code></pre>
                        </div>
                    </section>

                    <section id="multiple-texts" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Working with Multiple Texts</h2>
                        <p class="mb-4">Embed multiple texts efficiently by batching requests yourself:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">texts := []string{
    "First text to embed",
    "Second text to embed",
    "Third text to embed",
}

var embeddings [][]float64
for _, text := range texts {
    request := gai.EmbedRequest{
        Input: strings.NewReader(text),
    }
    response, err := client.Embed(context.Background(), request)
    if err != nil {
        // Handle error
    }
    embeddings = append(embeddings, response.Embedding)
}</code></pre>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-bold text-green-800 mb-1">Performance Tip</h4>
                            <p class="text-green-700 text-sm">When processing many documents, consider implementing goroutines and a worker pool to parallelize embedding requests. This can significantly improve throughput.</p>
                        </div>
                    </section>

                    <section id="semantic-search" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Practical Application: Semantic Search</h2>
                        <p class="mb-4">Basic semantic search implementation:</p>
                        
                        <div class="bg-gray-800 rounded-md overflow-hidden mb-6">
                            <pre><code class="language-go">func findSimilar(query string, documents []Document, client gai.Embedder[float64]) ([]Document, error) {
    // Embed the query
    queryEmbed, err := client.Embed(context.Background(), gai.EmbedRequest{
        Input: strings.NewReader(query),
    })
    if err != nil {
        return nil, err
    }
    
    // Calculate similarity to each document
    type docWithScore struct {
        doc   Document
        score float64
    }
    
    var scored []docWithScore
    for _, doc := range documents {
        similarity := eval.CosineSimilarity(queryEmbed.Embedding, doc.Embedding)
        scored = append(scored, docWithScore{doc: doc, score: float64(similarity)})
    }
    
    // Sort by similarity score
    sort.Slice(scored, func(i, j int) bool {
        return scored[i].score > scored[j].score
    })
    
    // Return documents sorted by relevance
    result := make([]Document, len(scored))
    for i, s := range scored {
        result[i] = s.doc
    }
    
    return result, nil
}</code></pre>
                        </div>
                        
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-100">
                                <h4 class="font-bold text-blue-800 mb-2">Step 1: Embed</h4>
                                <p class="text-sm text-blue-700">Convert the search query into a vector embedding</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-100">
                                <h4 class="font-bold text-blue-800 mb-2">Step 2: Compare</h4>
                                <p class="text-sm text-blue-700">Calculate similarity scores between query and document embeddings</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-100">
                                <h4 class="font-bold text-blue-800 mb-2">Step 3: Rank</h4>
                                <p class="text-sm text-blue-700">Sort documents by similarity score to return the most relevant results</p>
                            </div>
                        </div>
                    </section>

                    <section id="memory-efficiency" class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold text-blue-600 mb-4">Memory Efficiency</h2>
                        <p class="mb-4">For large embeddings, consider:</p>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Lower Precision</h3>
                                <p class="text-sm">Use float32 instead of float64 to reduce memory usage by 50%</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Quantization</h3>
                                <p class="text-sm">Use int8 for dramatically reduced memory footprint with minimal accuracy loss</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Dimensionality Reduction</h3>
                                <p class="text-sm">Techniques like PCA can compress vectors while preserving most information</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded border border-gray-200">
                                <h3 class="font-bold mb-2">Streaming</h3>
                                <p class="text-sm">Process large datasets incrementally to avoid loading everything into memory</p>
                            </div>
                        </div>
                        
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded mt-4">
                            <h4 class="font-bold text-red-800 mb-1">Important Note</h4>
                            <p class="text-red-700">Large datasets of embeddings can consume significant memory. Be mindful of your application's memory constraints, especially when deploying to environments with limited resources.</p>
                        </div>
                    </section>
                </div>
                
                <div class="mt-12 flex space-x-4">
                    <a href="chat-completion.html" class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded inline-flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        Chat Completion
                    </a>
                    <a href="tools.html" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded inline-flex items-center">
                        Tools
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </a>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between">
                <div class="mb-4 md:mb-0">
                    <h3 class="text-xl font-bold mb-2">GAI</h3>
                    <p class="text-gray-300">Go Artificial Intelligence - Work with AI models in Go</p>
                </div>
                <div>
                    <h4 class="font-bold mb-2 mt-4 md:mt-0">Links</h4>
                    <ul class="space-y-1">
                        <li><a href="https://github.com/maragudk/gai" class="text-blue-300 hover:text-white" target="_blank">GitHub Repository</a></li>
                        <li><a href="https://pkg.go.dev/maragu.dev/gai" class="text-blue-300 hover:text-white" target="_blank">Go Documentation</a></li>
                        <li><a href="mailto:markus@maragu.dk" class="text-blue-300 hover:text-white">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-4 border-t border-gray-700 text-center text-gray-400">
                <p>Made by <a href="https://www.maragu.dev/" class="text-blue-300 hover:text-white" target="_blank">maragu</a></p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>
</body>
</html>